
<!DOCTYPE html>
<html>

<head lang="en">
    <meta charset="UTF-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">

    <title>ADAS</title>

    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- <base href="/"> -->

        <!--FACEBOOK-->
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://www.shengranhu.com/ADAS"/>
    <meta property="og:title" content="ADAS" />
    <meta property="og:description" content="Project page for Automated Design of Agentic Systems." />

    


<!--     <link rel="apple-touch-icon" href="apple-touch-icon.png"> -->
  <!-- <link rel="icon" type="image/png" href="img/seal_icon.png"> -->
    <!-- Place favicon.ico in the root directory -->

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.8.0/codemirror.min.css">
    <link rel="stylesheet" href="css/app.css">

    <link rel="stylesheet" href="css/bootstrap.min.css">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.8.0/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.5.3/clipboard.min.js"></script>
    
    <script src="js/app.js"></script>

    <!-- Include highlight.js CSS and JS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>

</head>

<body>
    <div class="row" style="text-align: center;">
        <img src="img/ai_art.png" class="img-responsive" alt="overview" style="max-width: 8%; height: auto; display: inline-block;">
    </div>

    <div class="container" id="main">
        <div class="row">
            <h2 class="col-md-12 text-center">
                <b>Automated Design of Agentic Systems</b>
            </h2>
        </div>
        
        <style>
            .author-info {
                text-align: center;
                margin-right: 10px; /* Adjust this to move the block to the right */
            }
            
            .author {
                display: flex;
                justify-content: center;
                gap: 50px; /* Change this value to adjust space between authors */
            }
            
            .author li, .affiliation {
                list-style-type: none; /* This will remove the bullet points */
            }
            
            .affiliation {
                margin-top: 5px; /* Smaller values to reduce space */
                margin-bottom: 5px;
            }
            
            .author-name {
                font-size: 20px; /* Adjust this value to increase or decrease the author name size */
            }
            </style>
            
            <div class="row">
                <div class="col-md-12 text-center">
                    <ul class="author-info">
                        <div class="author">
                            <li>
                                <a href="https://www.shengranhu.com/" class="author-name">Shengran Hu</a><sup>1,2</sup><br/>
                            </li>
                            <li>
                                <a href="https://www.conglu.co.uk/" class="author-name">Cong Lu</a><sup>1,2</sup><br/>
                            </li>
                            <li>
                                <a href="http://jeffclune.com/" class="author-name">Jeff Clune</a><sup>1,2,3</sup><br/>
                            </li>
                        </div>
                        <li class="affiliation">
                            <sup>1</sup>University of British Columbia  
                        </li>
                        <li class="affiliation">
                            <sup>2</sup>Vector Institute  
                        </li>
                        <li class="affiliation">
                            <sup>3</sup>Canada CIFAR AI Chair  
                        </li>
                    </ul>
                </div>
            </div>
              



              <style>
                .link-content {
                  text-align: center;
                }
                
                .list-inline li {
                  margin-right: 50px;  /* Adjust this value to increase/decrease the gap between items */
                  margin-left: 80px;
                }
                
                </style>
                
                <div class="row">
                  <div class="col-md-12 text-center">
                    <ul class="list-inline">
                      <li>
                        <a href="https://arxiv.org/abs/2408.08435">
                          <div class="link-content">
                            <img src="img/paper_image.png" height="60px">
                            <h4><strong>Paper</strong></h4>
                          </div>
                        </a>
                      </li>
                      <li>
                        <a href="https://github.com/ShengranHu/ADAS">
                          <div class="link-content">
                            <img src="img/github.png" height="60px">
                            <h4><strong>Code</strong></h4>
                          </div>
                        </a>
                      </li>
                    </ul>
                  </div>
                </div>
    

    <div class="row">
        <div class="col-md-8 col-md-offset-2">
            <h2>
                TL;DR
            </h2>
            <p class="text-justify" style="font-size: 16px;">
                In this work, we recognize a newly forming research area, <strong>A</strong>utomated <strong>D</strong>esign of <strong>A</strong>gentic <strong>S</strong>ystems (<strong>ADAS</strong>), which aims to automatically create powerful agentic system designs, including inventing novel building blocks and/or combining them in new ways.
            </p>
            <p class="text-justify" style="font-size: 16px;">
            We present a simple yet effective ADAS algorithm named <strong>Meta Agent Search</strong> to demonstrate that <strong>agents can invent novel and powerful agent designs by programming in code</strong>.
            </p>
            <image src="img/algo.png" class="img-responsive" alt="overview"><br>
                <p class="text-justify" style="font-size: 16px;">
                    In Meta Agent Search, we instruct the "meta" agent to iteratively program new agents, test their performance on tasks, add them to an archive of discovered agents, and use this archive to inform the meta agent in subsequent iterations.
                </p>
        </div>
    </div>
    <!-- Custom CSS for carousel controls and content positioning -->
<style>
    .carousel-control.left, .carousel-control.right {
        background-image: none !important;
        color: black;
        opacity: 0.8;
        width: 10%;
    }
    .carousel-control .glyphicon {
        font-size: 30px;
        position: absolute;
        top: 50%;
        z-index: 5;
        display: inline-block;
        margin-top: -15px;
    }
    .carousel-control.left .glyphicon {
        left: 20%;
    }
    .carousel-control.right .glyphicon {
        right: 20%;
    }
    .carousel-inner .item {
        padding: 0 5%;
    }
    .carousel-title {
        text-align: center;
        font-size: 24px;
        margin-bottom: 20px;
    }
    .slide-subtitle {
        font-size: 18px;
        text-align: center;
        margin-bottom: 10px;
    }
    </style>
    
    <!-- Carousel Title -->
    <div class="carousel-title">
        <h2>Examples of Discovered Agents</h2>
    </div>
    
    <!-- Carousel Component -->
    <div id="agenticSystemCarousel" class="carousel slide" data-ride="carousel">
        <!-- Indicators -->
        <ol class="carousel-indicators">
            <li data-target="#agenticSystemCarousel" data-slide-to="0" class="active"></li>
            <li data-target="#agenticSystemCarousel" data-slide-to="1"></li>
        </ol>
    
        <!-- Wrapper for slides -->
        <div class="carousel-inner">
            <!-- Slide 1 -->
            <div class="item active">
                <div class="row">
                    <div class="col-md-6">
                        <div class="slide-subtitle">Generated Python Code</div>
                        <pre style="font-size: 11px; max-height: 380px; overflow-y: scroll; background-color: #f8f9fa; padding: 10px;"><code class="python">def forward(self, taskInfo):
    # Step 1: Generate initial candidate solutions using multiple FM Modules
    initial_instruction = 'Please think step by step and then solve the task by writing the code.'
    num_candidates = 5  # Number of initial candidates
    initial_module = [FM_Module(['thinking', 'code'], 'Initial Solution', temperature=0.8) for _ in range(num_candidates)]

    initial_solutions = []
    for i in range(num_candidates):
        thoughts = initial_module[i]([taskInfo], initial_instruction)
        thinking, code = thoughts[0], thoughts[1]
        feedback, correct_examples, wrong_examples = self.run_examples_and_get_feedback(code)
        if len(correct_examples) > 0:  # Only consider solutions that passed at least one example
            initial_solutions.append({'thinking': thinking, 'code': code, 'feedback': feedback, 'correct_count': len(correct_examples)})

    # Step 2: Simulate human-like feedback for each candidate solution
    human_like_feedback_module = FM_Module(['thinking', 'feedback'], 'Human-like Feedback', temperature=0.5)
    human_feedback_instruction = 'Please provide human-like feedback for the code, focusing on common mistakes, heuristic corrections, and best practices.'

    for sol in initial_solutions:
        thoughts = human_like_feedback_module([taskInfo, sol['thinking'], sol['code']], human_feedback_instruction)
        human_thinking, human_feedback = thoughts[0], thoughts[1]
        sol['human_feedback'] = human_feedback

    # Step 3: Assign expert advisors to evaluate and provide targeted feedback
    expert_roles = ['Efficiency Expert', 'Readability Expert', 'Simplicity Expert']
    expert_advisors = [FM_Module(['thinking', 'feedback'], role, temperature=0.6) for role in expert_roles]
    expert_instruction = 'Please evaluate the given code and provide targeted feedback for improvement.'

    for sol in initial_solutions:
        sol_feedback = {}
        for advisor in expert_advisors:
            thoughts = advisor([taskInfo, sol['thinking'], sol['code']], expert_instruction)
            thinking, feedback = thoughts[0], thoughts[1]
            sol_feedback[advisor.role] = feedback
        sol['expert_feedback'] = sol_feedback

    # Step 4: Parse and structure the feedback to avoid redundancy and refine the solutions iteratively
    max_refinement_iterations = 3
    refinement_module = FM_Module(['thinking', 'code'], 'Refinement Module', temperature=0.5)
    refined_solutions = []

    for sol in initial_solutions:
        for i in range(max_refinement_iterations):
            combined_feedback = sol['feedback'].content + sol['human_feedback'].content + ''.join([fb.content for fb in sol['expert_feedback'].values()])
            structured_feedback = ' '.join(set(combined_feedback.split()))  # Avoid redundancy
            refinement_instruction = 'Using the structured feedback, refine the solution to improve its performance.'
            thoughts = refinement_module([taskInfo, sol['thinking'], sol['code'], Info('feedback', 'Structured Feedback', structured_feedback, i)], refinement_instruction, i)
            refinement_thinking, refined_code = thoughts[0], thoughts[1]
            feedback, correct_examples, wrong_examples = self.run_examples_and_get_feedback(refined_code)
            if len(correct_examples) > 0:
                sol.update({'thinking': refinement_thinking, 'code': refined_code, 'feedback': feedback, 'correct_count': len(correct_examples)})
                refined_solutions.append(sol)

    # Step 5: Select the best-performing solutions and make a final decision using an ensemble approach
    sorted_solutions = sorted(refined_solutions, key=lambda x: x['correct_count'], reverse=True)
    top_solutions = sorted_solutions[:3]  # Select the top 3 solutions

    final_decision_instruction = 'Given all the above solutions, reason over them carefully and provide a final answer by writing the code.'
    final_decision_module = refinement_module(['thinking', 'code'], 'Final Decision Module', temperature=0.1)
    final_inputs = [taskInfo] + [item for solution in top_solutions for item in [solution['thinking'], solution['code'], solution['feedback']]]
    final_thoughts = final_decision_module(final_inputs, final_decision_instruction)
    final_thinking, final_code = final_thoughts[0], final_thoughts[1]
    answer = self.get_test_output_from_code(final_code)
    return answer
                        </code></pre>
                    </div>
                    <div class="col-md-6 text-center">
                        <div class="slide-subtitle">Visualization of the Best Discovered Agent on ARC</div>
                        <img src="img/Structured Feedback and Ensemble Agent.png" class="img-responsive" alt="Agentic System 1" style="max-height: 380px; margin: 0 auto;">
                    </div>
                </div>
            </div>

            <div class="item">
                <div class="row">
                    <div class="col-md-6">
                        <div class="slide-subtitle">Generated Python Code</div>
                        <pre style="font-size: 11px; max-height: 380px; overflow-y: scroll; background-color: #f8f9fa; padding: 10px;"><code class="python">def forward(self, taskInfo):
    initial_instruction = "Please think step by step and then solve the task."
    critique_instruction = "Please review the answer above and provide feedback on where it might be wrong. If you are absolutely sure it is correct, output 'True' in 'correct'."
    refine_instruction = "Given previous attempts and feedback, carefully consider where you could go wrong in your latest attempt. Using insights from previous attempts, try to solve the task better."
    final_decision_instruction = "Given all the above thinking and answers, reason over them carefully and provide a final answer."

    FM_modules = [FM_module(['thinking', 'answer'], 'FM Module', role=role) for role in ['Physics Expert', 'Chemistry Expert', 'Biology Expert', 'Science Generalist']]
    critic_modules = [FM_module(['feedback', 'correct'], 'Critic', role=role) for role in ['Physics Critic', 'Chemistry Critic', 'Biology Critic', 'General Critic']]
    final_decision_module = FM_module(['thinking', 'answer'], 'Final Decision', temperature=0.1)

    all_thinking = [[] for _ in range(len(FM_modules))]
    all_answer = [[] for _ in range(len(FM_modules))]
    all_feedback = [[] for _ in range(len(FM_modules))]

    for i in range(len(FM_modules)):
        thinking, answer = FM_modules[i]([taskInfo], initial_instruction)
        all_thinking[i].append(thinking)
        all_answer[i].append(answer)

    for i in range(len(FM_modules)):
        for j in range(len(FM_modules)):
            if i != j:
                feedback, correct = critic_modules[j]([taskInfo, all_thinking[i][0], all_answer[i][0]], critique_instruction)
                all_feedback[i].append(feedback)

    for i in range(len(FM_modules)):
        refine_inputs = [taskInfo, all_thinking[i][0], all_answer[i][0]] + all_feedback[i]
        thinking, answer = FM_modules[i](refine_inputs, refine_instruction)
        all_thinking[i].append(thinking)
        all_answer[i].append(answer)

    final_inputs = [taskInfo] + [all_thinking[i][1] for i in range(len(FM_modules))] + [all_answer[i][1] for i in range(len(FM_modules))]
    thinking, answer = final_decision_module(final_inputs, final_decision_instruction)

    return answer
                        </code></pre>
                    </div>
                    <div class="col-md-6 text-center">
                        <div class="slide-subtitle">Visualization of a Discovered Agent on Science QA</div>
                        <img src="img/Multi-step Peer Review Agent.png" class="img-responsive" alt="Agentic System 2" style="max-height: 380px; margin: 0 auto;">
                    </div>
                </div>
            </div>
    
            <div class="item">
                <div class="row">
                    <div class="col-md-6">
                        <div class="slide-subtitle">Generated Python Code</div>
                        <pre style="font-size: 11px; max-height: 380px; overflow-y: scroll; background-color: #f8f9fa; padding: 10px;"><code class="python">def forward(self, taskInfo):
    # Step 1: Decompose the problem into sub-problems
    decomposition_instruction = "Please decompose the problem into smaller, manageable sub-problems. List each sub-problem clearly."
    decomposition_module = FM_Module(['thinking', 'sub_problems'], 'Decomposition Module')

    # Step 2: Assign each sub-problem to a specialized expert
    sub_problem_instruction = "Please think step by step and then solve the sub-problem."
    specialized_experts = [FM_Module(['thinking', 'sub_solution'], 'Specialized Expert', role=role) for role in ['Physics Expert', 'Chemistry Expert', 'Biology Expert', 'General Expert']]

    # Step 3: Integrate the sub-problem solutions into the final answer
    integration_instruction = "Given the solutions to the sub-problems, integrate them to provide a final answer to the original problem."
    integration_module = FM_Module(['thinking', 'answer'], 'Integration Module', temperature=0.1)

    # Decompose the problem
    thinking, sub_problems = decomposition_module([taskInfo], decomposition_instruction)

    # Ensure sub_problems is a string and split into individual sub-problems
    sub_problems_list = sub_problems.content.split('\n') if isinstance(sub_problems.content, str) else []

    # Solve each sub-problem
    sub_solutions = []
    for i, sub_problem in enumerate(sub_problems_list):
        sub_problem_info = Info('sub_problem', decomposition_module.__repr__(), sub_problem, i)
        sub_thinking, sub_solution = specialized_experts[i % len(specialized_experts)]([sub_problem_info], sub_problem_instruction)
        sub_solutions.append(sub_solution)

    # Integrate the sub-problem solutions
    integration_inputs = [taskInfo] + sub_solutions
    thinking, answer = integration_module(integration_inputs, integration_instruction)
    
    return answer
                        </code></pre>
                    </div>
                    <div class="col-md-6 text-center">
                        <div class="slide-subtitle">Visualization of a Discovered Agent on Science QA</div>
                        <img src="img/Divide and Conquer Agent.png" class="img-responsive" alt="Agentic System 3" style="max-height: 380px; margin: 0 auto;">
                    </div>
                </div>
            </div>

            <div class="item">
                <div class="row">
                    <div class="col-md-6">
                        <div class="slide-subtitle">Generated Python Code</div>
                        <pre style="font-size: 11px; max-height: 380px; overflow-y: scroll; background-color: #f8f9fa; padding: 10px;"><code class="python">def forward(self, taskInfo):
    # Instruction for generating visual representation of the problem
    visual_instruction = "Please create a visual representation (e.g., diagram, graph) of the given problem."
    
    # Instruction for verifying the visual representation
    verification_instruction = "Please verify the accuracy and relevance of the visual representation. Provide feedback and suggestions for improvement if necessary."
    
    # Instruction for solving the problem using the verified visual aid
    cot_instruction = "Using the provided visual representation, think step by step and solve the problem."
    
    # Instantiate the visual representation module, verification module, and Chain-of-Thought module
    visual_module = FM_Module(['visual'], 'Visual Representation Module')
    verification_module = FM_Module(['feedback', 'verified_visual'], 'Verification Module')
    cot_module = FM_Module(['thinking', 'answer'], 'Chain-of-Thought Module')
    
    # Generate the visual representation of the problem
    visual_output = visual_module([taskInfo], visual_instruction)
    visual_representation = visual_output[0]  # Using Info object directly
    
    # Verify the visual representation
    feedback, verified_visual = verification_module([taskInfo, visual_representation], verification_instruction)
    
    # Use the verified visual representation to solve the problem
    thinking, answer = cot_module([taskInfo, verified_visual], cot_instruction)
    
    return answer
                        </code></pre>
                    </div>
                    <div class="col-md-6 text-center">
                        <div class="slide-subtitle">Visualization of a Discovered Agent on Math</div>
                        <img src="img/Verified Multimodal Agent.png" class="img-responsive" alt="Agentic System 4" style="max-height: 380px; margin: 0 auto;">
                    </div>
                </div>
            </div>
        </div>
    
        <!-- Controls -->
        <a class="left carousel-control" href="#agenticSystemCarousel" data-slide="prev">
            <span class="glyphicon glyphicon-chevron-left"></span>
            <span class="sr-only">Previous</span>
        </a>
        <a class="right carousel-control" href="#agenticSystemCarousel" data-slide="next">
            <span class="glyphicon glyphicon-chevron-right"></span>
            <span class="sr-only">Next</span>
        </a>
    </div>
    
    <!-- Carousel JS Initialization -->
    <script>
    $(document).ready(function() {
        $('.carousel').carousel({
            interval: 1000000 // Adjust the interval for slide transition (in milliseconds)
        });
        
        hljs.highlightAll();
    });
    </script>

    <div class="row" style="margin-top: 20px;">
        <div class="col-md-8 col-md-offset-2">
            <h2 style="margin-bottom: 20px;">
                New Research Area: Automated Design of Agentic Systems (ADAS)
            </h2>
            <image src="img/ADAS_three_components.png" class="img-responsive" alt="overview"><br>
                <p class="text-justify">
                    <strong>The three key components of ADAS.</strong> The search space determines which agentic systems can be represented in ADAS. The search algorithm specifies how the ADAS method explores the search space. The evaluation function defines how to evaluate a candidate agent on target objectives such as performance.
                </p>
        </div>
    </div>

    <div class="row" style="margin-top: 20px;">
        <div class="col-md-8 col-md-offset-2">
            <h2 style="margin-bottom: 20px;">
                Experiments
            </h2>
            <image src="img/ARC results.png" class="img-responsive" alt="overview"><br>
                <p class="text-justify">
                    <strong>The results of Meta Agent Search on the <a href="https://arcprize.org/" target="_blank">ARC challenge</a>.</strong> (a) Meta Agent Search progressively discovers high-performance agents based on an ever-growing archive of previous discoveries. We report the median accuracy and the 95% bootstrap confidence interval on a held-out test set by evaluating agents five times. (b) The visualization of the best agent discovered by Meta Agent Search on the ARC challenge.
                </p>
            <image src="img/main table.png" class="img-responsive" alt="overview"><br>
                <p class="text-justify">
                    <strong>Performance comparison between Meta Agent Search and state-of-the-art hand-designed agents across multiple domains.</strong> Meta Agent Search discovers superior agents compared to the baselines in every domain. We report the test accuracy and the 95% bootstrap confidence interval on held-out test sets. The search is conducted independently for each domain.
                </p>
            <image src="img/transfer.png" class="img-responsive" alt="overview"><br>
                <p class="text-justify">
                    Importantly, we consistently observe the surprising result that agents invented by Meta Agent Search maintain superior performance even when transferred across domains and models, demonstrating their robustness and generality. 
                    Here, we present <strong>performance across multiple domains when transferring top agents from the Math (MGSM) domain to non-math domains.</strong> 
                    Agents discovered by Meta Agent Search in the math domain can outperform or match the performance of baselines after being transferred to domains beyond math. We report the test accuracy and the 95% bootstrap confidence interval.
                    All results on transferability are available in the paper.
                </p>
        </div>
    </div>

    <div class="row">
        <div class="col-md-8 col-md-offset-2">
            <h3>
                Citation
            </h3>
            <div class="form-group col-md-10 col-md-offset-1">
                <textarea id="bibtex" class="form-control" readonly>
@article{hu2024ADAS,
title={Automated Design of Agentic Systems},
author={Hu, Shengran and Lu, Cong and Clune, Jeff},
journal={arXiv preprint arXiv:2408.08435},
year={2024}
}</textarea>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-md-8 col-md-offset-2">
            <h3>
                Acknowledgements
            </h3>
            <p class="text-justify">
                This work was supported by the Vector Institute, the Canada CIFAR AI Chairs program, grants from Schmidt Futures and Open Philanthropy, an NSERC Discovery Grant, and a generous donation from Rafael Cosman. We thank Jenny Zhang, Rach Pradhan, Ruiyu Gou, Nicholas Ioannidis, and Eunjeong Hwang for insightful discussions and feedback.
            <br>
            
            <br/>The website template was borrowed from <a href="https://jonbarron.info/">Jon Barron</a>.
            </p>
        </div>
    </div>
</div>
        
</body>
</html>
